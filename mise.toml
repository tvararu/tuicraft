[tools]
bun = "latest"

[settings]
# We use a very short timeout to enforce a fast test suite and fast build. The
# only exception is `mise test:live` which hits a live server and has network
# latency and actually implements `sleep`s out of necessity. If mise tasks are
# timing out, it means you need to make them faster, NOT increase the timeout.
task_timeout = "500ms"  # CLAUDE: DO NOT CHANGE THIS OR YOU WILL BE FIRED.

[tasks.bundle]
description = "Install dependencies"
run = "bun install"

[tasks.build]
description = "Compile single binary"
run = "bun build --compile src/index.ts --outfile dist/tuicraft"

[tasks.test]
description = "Run all tests"
run = "bun test"

[tasks."test:live"]
description = "Run tests against a live server"
run = "bun test ./src/test/live.ts"

[tasks."test:coverage"]
description = "Run tests with coverage report"
run = "bun test --coverage"

[tasks.ci]
description = "Run all CI checks in parallel"
run = "mise typecheck ::: test ::: format"

[tasks.typecheck]
description = "Type-check with tsc"
run = "bun run typecheck"

[tasks.format]
description = "Check formatting"
run = "bunx prettier --check src/"

[tasks."format:fix"]
description = "Fix formatting"
run = "bunx prettier --write src/"
